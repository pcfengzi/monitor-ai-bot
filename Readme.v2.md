ä¸‹é¢æ˜¯æ ¹æ®ä½ å½“å‰é¡¹ç›®æœ€æ–°ç»“æ„ & æ¶æ„ï¼ˆbot-host â†’ SQLite â†’ api-server â†’ dashboard-frontend-reactï¼‰**å®Œæ•´é‡å†™çš„ README.mdï¼ˆä¼ä¸šçº§è´¨é‡ï¼‰**ã€‚

ä½ å¯ä»¥ç›´æ¥ copy åˆ°ä½ çš„ä»“åº“æ ¹ç›®å½•è¦†ç›–åŸæ¥çš„ç‰ˆæœ¬ã€‚

---

# ğŸš€ Monitor AI Botï¼ˆç›‘æ§ AI æœºå™¨äººï¼‰

Monitor AI Bot æ˜¯ä¸€ä¸ªåŸºäº **Rust æ’ä»¶ç³»ç»Ÿï¼ˆåŠ¨æ€åº“ï¼‰ + å¤šè¿›ç¨‹æ¶æ„ + SQLite å­˜å‚¨ + Web Dashboard** çš„è½»é‡çº§ç›‘æ§å¹³å°æ¡†æ¶ã€‚

ä½ å¯ä»¥é€šè¿‡æ‰©å±• Rust æ’ä»¶åŠ¨æ€åº“ï¼ˆDLL/so/dylibï¼‰æ¥è‡ªå®šä¹‰å„ç§ç›‘æ§èƒ½åŠ›ï¼Œä¾‹å¦‚ï¼š

* CPU / å†…å­˜ / ç£ç›˜
* API å»¶è¿Ÿ / æ¥å£å¯ç”¨æ€§
* ä¸šåŠ¡æ•°æ®æ£€æŸ¥
* AI æ¨¡å‹å¥åº·çŠ¶å†µ
* è‡ªå®šä¹‰æŒ‡æ ‡é‡‡æ ·

å¹¶é€šè¿‡ Web Dashboard è¿›è¡Œå®æ—¶å¯è§†åŒ–ã€‚

---

# âœ¨ æ¶æ„æ¦‚è¦

å½“å‰ç³»ç»Ÿç”±ä¸‰ä¸ªæ ¸å¿ƒæ¨¡å—ç»„æˆï¼š

```
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚      dashboard          â”‚
                 â”‚  (React å‰ç«¯å¯è§†åŒ–é¡µé¢) â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ HTTP API
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚       api-server        â”‚
                 â”‚   (ä» SQLite è¯»å–æ•°æ®)  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          å†™å…¥ DB
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚        bot-host         â”‚
                 â”‚(åŠ è½½æ’ä»¶â†’æ‰§è¡Œâ†’å†™ SQLite)â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          FFI è°ƒç”¨
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚      Rust æ’ä»¶ç³»ç»Ÿ      â”‚
                 â”‚    *.dll / *.so / dylib â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### bot-host

è´Ÿè´£æ‰§è¡Œæ’ä»¶ã€é‡‡é›† Metric/Logï¼Œå†™å…¥ SQLiteã€‚

### api-server

åªåšä¸€ä»¶äº‹ï¼šä» SQLite è¯»å–æ•°æ®å¹¶æä¾› HTTP APIï¼ˆ/logs /metricsï¼‰ã€‚

### dashboard-frontend-react

ä¸€ä¸ª React + TS çš„å‰ç«¯åº”ç”¨ï¼Œå®æ—¶å±•ç¤º API è¿”å›çš„æ•°æ®ã€‚

---

# ğŸ“‚ å½“å‰é¡¹ç›®ç»“æ„ï¼ˆä¸ä½ å®é™…é¡¹ç›®å®Œå…¨ä¸€è‡´ï¼‰

```
monitor-ai-bot/
â”‚
â”œâ”€â”€ api-server/               # å•ç‹¬è¿›ç¨‹ï¼Œæä¾› HTTP API
â”‚   â””â”€â”€ src/main.rs
â”‚
â”œâ”€â”€ bot-host/                 # ä¸»ç¨‹åºï¼šæ’ä»¶è°ƒåº¦ + å†™ SQLite
â”‚   â””â”€â”€ src/main.rs
â”‚
â”œâ”€â”€ core-types/               # Metric / Log äº‹ä»¶ç»“æ„ä½“ï¼ˆHost å’Œ API å…±äº«ï¼‰
â”‚   â””â”€â”€ src/lib.rs
â”‚
â”œâ”€â”€ dashboard-frontend-react/ # å‰ç«¯ä»ªè¡¨ç›˜ï¼ˆReactï¼‰
â”‚   â””â”€â”€ src/App.tsx
â”‚
â”œâ”€â”€ plugin-api/               # æ’ä»¶ ABI æ¥å£å®šä¹‰ï¼ˆC ABIï¼‰
â”‚   â””â”€â”€ src/lib.rs
â”‚
â”œâ”€â”€ plugins/                  # æ’ä»¶æºç ä½ç½®ï¼ˆRust Cratesï¼‰
â”‚   â””â”€â”€ cpu-monitor/
â”‚       â””â”€â”€ src/lib.rs
â”‚
â”œâ”€â”€ plugins-bin/              # ç”Ÿäº§ç¯å¢ƒæ’ä»¶ï¼ˆDLL/so/dylibï¼‰
â”‚
â”œâ”€â”€ storage/                  # SQLite å°è£…ï¼ˆHost & API å…±ç”¨ï¼‰
â”‚   â””â”€â”€ src/lib.rs
â”‚
â”œâ”€â”€ .env                      # ç¯å¢ƒå˜é‡ï¼ˆdev/prod æ¨¡å¼ç­‰ï¼‰
â”œâ”€â”€ config.toml               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ Cargo.toml                # Workspace
â””â”€â”€ Readme.md
```

---

# âš™ï¸ å®‰è£…ä¸è¿è¡Œ

## 1. å¯åŠ¨ bot-hostï¼ˆæ‰§è¡Œæ’ä»¶ â†’ å†™å…¥ SQLiteï¼‰

```
cargo run -p bot-host
```

æˆåŠŸåä½ ä¼šçœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š

```
=== ç›‘æ§AIæœºå™¨äºº bot-host å¯åŠ¨ ===
è¿æ¥ SQLite æˆåŠŸ: sqlite:monitor_ai.db
å‘ç°æ’ä»¶: cpu_monitor.dll
æ‰§è¡Œæ’ä»¶...
```

host ä¼šæŒç»­è°ƒåº¦æ’ä»¶å¹¶å†™å…¥ `monitor_ai.db` æ•°æ®åº“ã€‚

---

## 2. å¯åŠ¨ api-serverï¼ˆè¯»å– SQLite â†’ æä¾› APIï¼‰

```
cargo run -p api-server
```

æˆåŠŸåï¼š

```
api-server å¯åŠ¨ï¼š http://127.0.0.1:3001/logs
```

API ç¤ºä¾‹ï¼š

* GET [http://127.0.0.1:3001/metrics](http://127.0.0.1:3001/metrics)
* GET [http://127.0.0.1:3001/logs](http://127.0.0.1:3001/logs)

---

## 3. å¯åŠ¨å‰ç«¯ Dashboard

```
cd dashboard-frontend-react
npm install
npm run dev
```

æµè§ˆå™¨è®¿é—®ï¼š

```
http://127.0.0.1:5173
```

ä½ å°†çœ‹åˆ°ç›‘æ§æ•°æ®çš„å¯è§†åŒ–è¡¨æ ¼ï¼ˆåç»­å¯å‡çº§ä¸ºå›¾è¡¨ï¼‰ã€‚

---

# ğŸ§© æ’ä»¶å¼€å‘æŒ‡å—

## åˆ›å»ºæ’ä»¶

```
cargo new plugins/my-plugin --lib
```

ä¿®æ”¹ `Cargo.toml`ï¼š

```toml
[lib]
crate-type = ["cdylib"]

[dependencies]
plugin-api = { path = "../../plugin-api" }
```

æ’ä»¶å¿…é¡»å¯¼å‡ºï¼š

* `meta()`ï¼šè¿”å›æ’ä»¶å…ƒä¿¡æ¯ï¼ˆåç§°/ç‰ˆæœ¬/ç±»åˆ«ï¼‰
* `run()`ï¼ˆæ—§ç‰ˆæ¥å£ï¼‰
* æˆ– `run_with_ctx(ctx)`ï¼ˆæ–°ç‰ˆæ¥å£ï¼Œå¯ä½¿ç”¨ä¸Šä¸‹æ–‡ä¸ŠæŠ¥æ—¥å¿—/metricï¼‰

### ä¸€ä¸ªæœ€å°å¯è¿è¡Œæ’ä»¶

```rust
use plugin_api::{PluginMeta};
use std::os::raw::c_char;

static NAME: &[u8] = b"cpu-monitor\0";
static VERSION: &[u8] = b"0.1.0\0";
static KIND: &[u8] = b"cpu\0";

#[unsafe(no_mangle)]
pub extern "C" fn run() {
    println!("[cpu-monitor] run() executed");
}

#[unsafe(no_mangle)]
pub extern "C" fn meta() -> PluginMeta {
    PluginMeta {
        name: NAME.as_ptr() as *const c_char,
        version: VERSION.as_ptr() as *const c_char,
        kind: KIND.as_ptr() as *const c_char,
    }
}
```

---

# ğŸ› ï¸ ç›‘æ§æ•°æ®ï¼ˆMetric ä¸ Logï¼‰

### Metricï¼ˆæŒ‡æ ‡ï¼‰

* æ•°å€¼å‹æ•°æ®ï¼ˆCPU ä½¿ç”¨ç‡ã€å†…å­˜å¤§å°ç­‰ï¼‰
* æ’ä»¶é€šè¿‡ `ctx.emit_metric_fn` ä¸ŠæŠ¥
* bot-host å†™å…¥ SQLite
* api-server é€šè¿‡ `/metrics` æä¾›

### Logï¼ˆç›‘æ§äº‹ä»¶æ—¥å¿—ï¼‰

* æ’ä»¶é€šè¿‡ `ctx.log_fn` ä¸ŠæŠ¥
* bot-host å†™ SQLite
* api-server é€šè¿‡ `/logs` æä¾›

---

# ğŸ”§ config.toml é…ç½®ç¤ºä¾‹

```toml
[plugin]
mode = "dev"
dev_dir = "target/debug"
prod_dir = "plugins-bin"
name_pattern = "_monitor"
default_interval = 5
auto_load = true

[plugins.cpu]
enabled = true
interval_secs = 5
```

---

# ğŸ”¥ æœªæ¥å¯æ‰©å±•èƒ½åŠ›

ä½ å·²ç»å…·å¤‡ä¸€ä¸ªâ€œå¹³å°çº§ç›‘æ§ç³»ç»Ÿçš„åœ°åŸºâ€ï¼Œæœªæ¥éå¸¸å®¹æ˜“æ‰©å±•ï¼š

## ğŸ“ˆ 1. å¯è§†åŒ–å›¾è¡¨ï¼ˆæŠ˜çº¿å›¾/é¥¼å›¾/EChartsï¼‰

æ”¯æŒå®æ—¶æ˜¾ç¤ºæŒ‡æ ‡è¶‹åŠ¿ã€‚

## ğŸ§  2. AI å¼‚å¸¸æ£€æµ‹æ¨¡å‹

åŸºäº Metric åºåˆ—ï¼ˆCPU/Memory æ›²çº¿ï¼‰ï¼Œå¯åŠ ï¼š

* LOF/Isolation Forest
* LSTM/Transformer
* Prophet è¶‹åŠ¿é¢„æµ‹

## ğŸ“¨ 3. æ’ä»¶é—´é€šä¿¡ï¼ˆäº‹ä»¶æ€»çº¿ï¼‰

å¦‚ï¼š

```
cpu-monitor â†’ event â†’ ai-engine â†’ alert
```

## ğŸ”Œ 4. æ›´å¤šæ’ä»¶ç±»å‹

å¦‚ï¼š

* HTTP æ¢æ´»æ’ä»¶
* Redis/MySQL ç›‘æ§æ’ä»¶
* Linux systemd è¿›ç¨‹ç›‘æ§æ’ä»¶
* Docker/K8S çŠ¶æ€é‡‡é›†æ’ä»¶

---

# ğŸ¯ æ€»ç»“

ä½ ç°åœ¨çš„ Monitor AI Bot å·²ç»å…·å¤‡ï¼š

| èƒ½åŠ›                   | çŠ¶æ€       |
| -------------------- | -------- |
| æ’ä»¶åŠ¨æ€åŠ è½½               | âœ” å·²å®ç°    |
| æ’ä»¶ä¸Šä¸‹æ–‡ API            | âœ” å·²å®ç°    |
| æ’ä»¶çƒ­æ’æ‹”                | âœ” å·²å®ç°    |
| å¤šæ’ä»¶è°ƒåº¦                | âœ” å·²å®ç°    |
| SQLite å­˜å‚¨ Metric/Log | âœ” å·²å®ç°    |
| åˆ†ç¦» API Server        | âœ” å·²å®ç°    |
| React å‰ç«¯ Dashboard   | âœ” å·²å®ç°    |
| å¯æ‰©å±• AI / MQ / Charts | ğŸ”œ å¯éšæ—¶æ‰©å±• |

**è¿™å·²ç»æ˜¯ä¸€ä¸ªå®Œæ•´çš„â€œå¾®å‹ä¼ä¸šçº§ç›‘æ§ç³»ç»Ÿæ¡†æ¶â€äº†ã€‚**

---

å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥ç»§ç»­å¸®ä½ åšï¼š

ğŸ˜Š **ä¸‹ä¸€æ­¥å»ºè®®ï¼šç»™ Dashboard æ·»åŠ  ECharts å›¾è¡¨ï¼Œç»˜åˆ¶ CPU ä½¿ç”¨ç‡æ›²çº¿ã€‚**

ç»§ç»­å—ï¼Ÿ
